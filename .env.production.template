# ============================================================
# PRODUCTION ENVIRONMENT — copy to .env on your VPS
# .env is gitignored — NEVER commit this file with real values
#
# CÁCH NHANH NHẤT: chạy lệnh này để tự động tạo .env + IAM key:
#   npm run setup:prod
# ============================================================

APP_NAME=vinhsatan_internal_app
APP_ENV=production
APP_DOMAIN=app.n8nvinhsatan.site    # your VPS domain

# --- Auth mode ---
VITE_AUTH_MODE=single_user          # single owner; set to '' for multi-user
VITE_API_URL=https://app.n8nvinhsatan.site

# Turn OFF to enable real-time sync to PostgreSQL (requires DB below)
# Turn ON (true) to use localStorage only — data lives in browser only
VITE_NO_SERVER_SYNC=false

# --- Single-user credentials ---
# CHANGE THESE before deploying!
AUTH_EMAIL=your@email.com
AUTH_PASSWORD=CHANGE_ME_strong_password

# --- JWT signing secret (MUST be a long random string in production) ---
# Generate with: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
IAM_PRIVATE_KEY=CHANGE_ME_generate_with_crypto_randomBytes_64

# --- PostgreSQL database (required when VITE_NO_SERVER_SYNC=false) ---
DB_CONN=postgres://user:password@localhost:5432/dbname
DB_HOST=localhost
DB_NAME=internal_db
DB_USER=internal_user
DB_PASS=CHANGE_ME_db_password

# --- Optional: Telegram notifications ---
TELEGRAM_BOT_TOKEN=
TELEGRAM_CHAT_ID=

# --- Orchestrator (optional, only if using Temporal/Argo) ---
TEMPORAL_ADDRESS=localhost:7233
ARGO_SERVER=http://localhost:2746
ARGO_NAMESPACE=default
IAM_KMS_SIGN_URL=
ORCHESTRATOR=temporal

# ============================================================
# VPS DEPLOYMENT STEPS
# ============================================================
# 1. Install: Node 20+, PostgreSQL (if using DB), Nginx, PM2
#    sudo apt install -y nodejs npm postgresql nginx
#    npm install -g pm2
#
# 2. Clone repo & install:
#    git clone https://github.com/vinhsatan/webtinhtienvinh.git
#    cd webtinhtienvinh && npm install
#
# 3. Configure environment:
#    cp .env.production.template .env
#    nano .env    # fill in real values above
#
# 4. Run DB migrations (if VITE_NO_SERVER_SYNC=false):
#    export DB_CONN="postgres://user:pass@localhost:5432/dbname"
#    for f in database/migrations/*.sql; do psql "$DB_CONN" -f "$f"; done
#
# 5. Build:
#    npm run build
#
# 6. Start with PM2:
#    pm2 start "npm run prod" --name web
#    pm2 save && pm2 startup
#
# 7. Nginx: copy nginx/app.production.conf to /etc/nginx/sites-available/
#    and symlink to /etc/nginx/sites-enabled/
#    sudo certbot --nginx -d app.n8nvinhsatan.site
#    sudo nginx -t && sudo systemctl reload nginx
# ============================================================
